version: "3.8"
services:
  shll-web:
    image: ghcr.io/kledx/shll-web:latest
    pull_policy: always
    restart: unless-stopped
    # ports:
    #   - "3000:3000"
    environment:
      - NODE_ENV=production
      - PORT=3000
      - HOSTNAME=0.0.0.0

      # ─── Backend Service URLs ───
      - PONDER_URL=http://shll-indexer:42069
      - RUNNER_URL=http://shll-agent-runner:8787
      - RUNNER_API_KEY=${RUNNER_API_KEY:-}
      - API_KEY=${API_KEY:-}

      # ─── Contract Addresses (V3.1 — BSC Testnet) ───
      - NEXT_PUBLIC_AGENT_NFA=${NEXT_PUBLIC_AGENT_NFA:-0xbB5059ad07bBd2d10d2e67fF842ce2D5e55eCD82}
      - NEXT_PUBLIC_LISTING_MANAGER=${NEXT_PUBLIC_LISTING_MANAGER:-0x58edca3cd175a3e306e9b16125fec75483681cf6}
      - NEXT_PUBLIC_POLICY_GUARD_V3=${NEXT_PUBLIC_POLICY_GUARD_V3:-0x31Bd83f2C3A41154F88296c145E36A64E32729A5}
      - NEXT_PUBLIC_DEPLOY_BLOCK=${NEXT_PUBLIC_DEPLOY_BLOCK:-91078300}

      # ─── Chain ───
      - NEXT_PUBLIC_CHAIN_ID=${NEXT_PUBLIC_CHAIN_ID:-97}
      - NEXT_PUBLIC_RPC_URL=${NEXT_PUBLIC_RPC_URL:-https://data-seed-prebsc-1-s1.bnbchain.org:8545}
      - NEXT_PUBLIC_ROUTER_ADDRESS=${NEXT_PUBLIC_ROUTER_ADDRESS:-0xD99D1c33F9fC3444f8101754aBC46c52416550D1}

      # ─── UI Config ───
      - NEXT_PUBLIC_POLICYGUARD_VERSION=${NEXT_PUBLIC_POLICYGUARD_VERSION:-v4}
      - NEXT_PUBLIC_EXPLORER_TX_BASE_URL=${NEXT_PUBLIC_EXPLORER_TX_BASE_URL:-https://testnet.bscscan.com/tx}
      - NEXT_PUBLIC_RUNNER_OPERATOR=${NEXT_PUBLIC_RUNNER_OPERATOR:-}
      - NEXT_PUBLIC_ADMIN_WALLET=${NEXT_PUBLIC_ADMIN_WALLET:-}
      - NEXT_PUBLIC_OWNER_ADDRESS=${NEXT_PUBLIC_OWNER_ADDRESS:-}
      - NEXT_PUBLIC_EXTRA_TOKENS=${NEXT_PUBLIC_EXTRA_TOKENS:-}

    networks:
      - dokploy-network

networks:
  dokploy-network:
    external: true
